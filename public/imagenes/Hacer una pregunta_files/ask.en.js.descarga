"use strict";StackExchange.ready(function(){function t(){var t=d.data("validation-errors"),n=d.data("validation-warnings");(t||n)&&StackExchange.postValidation.showErrorsAfterSubmission(d,u.Question,v,t,n)}function n(t,n,e){S&&StackExchange.using("gps",function(){StackExchange.gps.track(t,n,e),e&&j.trigger()})}function e(t,e,a){a.forEach(function(a){t.one(a,function(){n("question.action",{"action_type":e+"_"+a},!0)})})}function a(t,n){try{W||(A.removeClass("dno"),StackExchange[m].finallyInit(g.prop("id")),W=!0,d.data("delay-validation")||StackExchange.using("postValidation",function(){StackExchange.postValidation.initOnBlur(A,u.Answer,"post",!1)})),O.fadeTo(t?0:400,1,n)}catch(e){setTimeout(function(){a(t,n)},10)}}function o(){var t=P.find('[data-kp="'+(StackExchange.options.site.routePrefix||"")+'"]').index();P.prop("selectedIndex",t)}function i(){B.addClass("is-loading"),StackExchange.cardiologist.ensureDraftSaved(function(){},!0),StackExchange.postValidation.validatePostFields(d,u.Question,v,!1,function(){return $(".js-visible-before-review").fadeOut().promise()}).then(function(){d.data("delay-validation",!1),StackExchange.postValidation.initOnBlurAndSubmit(d,u.Question,v,!1),C.is(":checked")&&(StackExchange.postValidation.initOnBlur(A,u.Answer,"post",!1),StackExchange.postValidation.validatePostFields(A,u.Answer,"post",!1))}).then(function(){$(".js-visible-during-review").removeClass("d-none").hide().fadeIn(),StackExchange.postValidation.scrollToErrors()}).fail(function(){B.removeClass("is-loading")})}function s(t){var n=[],e=function(t){for(var e=0,a=t;e<a.length;e++){var o=a[e];-1===n.indexOf(o)&&n.push(o)}};return e(t.Title),e(t.Body),e(t.Tags),n}function r(){Y||(Y=$('<input name="distinctErrorCount" type="hidden">').appendTo(d),V=$('<input name="distinctWarningCount" type="hidden">').appendTo(d),L=$('<input name="unresolvedWarningCount" type="hidden">').appendTo(d));var t=X.namedWarnings.map(function(t){return t.bodies});X.unnamedWarnings&&t.push(X.unnamedWarnings),Y.val(X.distinctErrorCount),V.val(t.length),L.val(t.filter(function(t){return s(t).length>0}).length)}function c(){function t(t,e){var a=s(e),r=a.length>0,c=$("<div>").html(n.find(".js-warning-template").text());c.find(".js-guidance-title").text(t),c.find(".js-separator").toggleClass("d-none",i.is(":empty")),c.find(".js-success-icon").toggleClass("d-none",r),c.find(".js-warning-icon").toggleClass("d-none",!r);var u=c.find(".js-guidance-body").toggleClass("d-none",!r);if(r){o=!1;for(var d=0,l=a;d<l.length;d++){var f=l[d];$('<div class="flex--item" />').html(f).appendTo(u)}}u.find("a").attr("target","_blank"),c.children().appendTo(i)}var n=$(".js-post-review-summary");if(0!==n.length&&X.loaded.Title&&X.loaded.Body&&X.loaded.Tags){var e=X.errors.Title+X.errors.Body+X.errors.Tags,a=!!X.unnamedWarnings||X.namedWarnings.length>0;n.find(".js-loading-message").addClass("d-none"),n.find(".js-success-no-warnings").toggleClass("d-none",e>0||a),n.find(".js-error-container").toggleClass("d-none",0===e),n.find(".js-warning-and-error-separator").toggleClass("d-none",0===e||!a),n.find(".js-warning-container").toggleClass("d-none",!a),e>0&&n.find(".js-error-message").text(function(t){return 1==t.__count,"Resolve "+t.__count+" issues before posting"}({"__count":e}));for(var o=0===e,i=n.find(".js-warning-list").empty(),r=0,c=X.namedWarnings;r<c.length;r++){var u=c[r];t(u.name,u.bodies)}X.unnamedWarnings&&t("Other suggestions",X.unnamedWarnings),n.find(".js-resolved-warnings-message").toggleClass("d-none",!o),n.find(".js-unresolved-warnings-message").toggleClass("d-none",o)}}StackExchange.helpers.removeParameterFromQueryString("fromen");var u=StackOverflow.Models.PostTypeId,d=$(".js-post-form"),l=d.find(".js-post-title-field"),f=d.find(".js-post-body-field[data-post-type-id="+u.Question+"]"),p=d.find(".js-post-tags-field"),g=d.find(".js-post-body-field[data-post-type-id="+u.Answer+"]"),h=d.find(".js-similar-questions"),v=d.data("form-type")||"question",b=$(".js-stacks-editor-container").length>0,m=b?"stacksEditor":"editor";d.data("delay-validation")||StackExchange.using("postValidation",function(){d.data("has-answer")||t(),StackExchange.postValidation.initOnBlurAndSubmit(d,u.Question,v,!1)});var k={"siteName":document.title.substr(document.title.indexOf(" - ")+3),"onResults":function(t){null!==t&&S&&(n("question_ask.suggestions_show",{}),StackExchange.using("gps",function(){t.addClass("js-gps-track").data("gps-track","question_ask.suggestion_click similarquestions.title_link_clicked"),StackExchange.gps.bindTrackClicks(h)}))}};StackExchange.question.initTitleSearch(l,h,k);var y=$(".js-ask-public"),w=$(".js-submit-button"),x=$(".js-question-form-overlay"),E=!1;x.length>0&&(E=!0,x.find(":input").prop("disabled",E)),y.change(function(){var t=this.checked;E=!t,y.prop("checked",t),w.prop("disabled",!t),x.toggleClass("pe-none o30",!t).find(":input").prop("disabled",!t)}),$(".js-tag-suggestions").length>0&&StackExchange.using("tagSuggestions",function(){StackExchange.tagSuggestions.init()});var _=d.data("required-tags");_&&StackExchange.using("tagEditor",function(){StackExchange.tagEditor.requiredTags=_});var q=d.data("force-heartbeat-at-body-length");q&&StackExchange.using(m,function(){var t=setInterval(function(){f.val().length>=q&&(clearInterval(t),StackExchange.cardiologist.beatASAP())},3e3)});var S=d.data("enable-analytics"),T=d.data("enable-warning-analytics"),j=StackExchange.helpers.DelayedReaction(function(){return StackExchange.gps.sendPending()},3e3);n("question_ask.visit",{"inbox_subscription":d.data("inbox-subscription"),"referrer":d.data("referrer")}),e(l,"title",["blur"]),e(f,"body",["focus","blur"]),e(p,"tags",["focus","blur"]);var C=$(".js-post-answer-while-asking-checkbox"),W=!1,A=$("#question-answer-section"),I=$(".js-show-on-question-only"),O=$(".js-show-on-question-and-answer");C.change(function(){var t=C.get(0);t.disabled=!0,C.is(":checked")?I.fadeOut(function(){a(!1,function(){g.focus(),t.disabled=!1})}):O.fadeOut(function(){I.fadeIn(function(){t.disabled=!1})})}),(C.is(":checked")||d.data("has-answer"))&&(C.attr("checked","checked"),I.hide(),StackExchange.using(m,function(){setTimeout(function(){a(!0,t)},2)}));var P=$(".js-inline-channel-switcher");P.length>0&&($(window).on("load",o),P.off("change"),P.on("change",function(){var t=P.val();if(t&&t.length){var n=l.val().length>0||f.val().length>0||g.val().length>0;if(n){var e=StackExchange.options.user.fkey,a=e.lastIndexOf("/");a>=0&&(e=e.substr(a+1));var i=P.find(":selected").data("kp");i&&i.length&&(e=i+"/"+e);var s=$('#post-form input[name="fkey"]'),r=s.val();s.val(e),x.find(":input").prop("disabled",!E);var c=$("#post-form").serialize();x.find(":input").prop("disabled",E),s.val(r),$.ajax({"url":t+"/save-draft","type":"POST","data":c,"success":function(){window.onbeforeunload=null,$.post("/post/discard-draft",{"fkey":StackExchange.options.user.fkey,"postType":"ask"}),window.location=t},"error":function(){o();var t={"position":{"my":"left top","at":"right center"},"css":{"width":"200px"}};StackExchange.helpers.showErrorMessage($(".js-inline-channel-switcher"),"An error occurred. Please try again later.",t)},"doNotRewriteUrl":!0})}else window.location=t}return!1}));var B=$(".js-begin-review-button");B.click(i),d.on("post:will-submit",function(t){B.length>0&&d.data("delay-validation")&&(t.preventDefault(),i())});var X={"loaded":{"Title":!1,"Body":!1,"Tags":!1},"errors":{"Title":0,"Body":0,"Tags":0},"namedWarnings":[],"observedErrors":{},"distinctErrorCount":0};d.on("post:validated-field",function(t,e){if(e.postTypeId===u.Question){var a=e.field;if("Title"===a||"Body"===a||"Tags"===a){X.loaded[a]=!0,X.errors[a]=e.errors.length,e.errors.forEach(function(t){X.observedErrors[t]||(X.observedErrors[t]=!0,X.distinctErrorCount+=1)});var o={},i=[];e.warnings.forEach(function(t){var n=$("<div>").html(t),e=n.get(0).childNodes;if(e.length<3||"B"!==e[0].nodeName||"BR"!==e[1].nodeName||$(e[0]).children().length>0)return i.push(t),void 0;for(var a=$(e[0]).remove().text();n.children().first().is("br");)n.children().first().remove();var s=$.trim(n.html());return 0===s.length?(i.push(t),void 0):(o[a]||(o[a]=[]),o[a].push(s),void 0)}),X.namedWarnings.forEach(function(t){t.bodies[a]=o[t.name]||[],delete o[t.name]});for(var s in o){var d={"name":s,"bodies":{"Title":[],"Body":[],"Tags":[]}};d.bodies[a]=o[s],X.namedWarnings.push(d),T&&n("question_ask.warning_show",{"name":s},!0)}(X.unnamedWarnings||i.length>0)&&(X.unnamedWarnings||(X.unnamedWarnings={"Title":[],"Body":[],"Tags":[]},T&&n("question_ask.warning_show",{},!0)),X.unnamedWarnings[a]=i),r(),c()}}}),d.on("post:submit-completed",function(t,e){e.response.success&&S&&T&&StackExchange.gps&&(X.namedWarnings.forEach(function(t){n("question_ask.warning_resolution",{"name":t.name,"resolved":0===s(t.bodies).length},!0)}),X.unnamedWarnings&&n("question_ask.warning_resolution",{"resolved":0===s(X.unnamedWarnings).length},!0))});var Y,V,L;if(StackExchange.settings.questions.enableQuestionTitleLengthLiveWarning){var N=StackExchange.settings.questions.maxTitleSize,R=StackExchange.settings.questions.questionTitleLengthStartLiveWarningChars,Q=N-R,H=$("#title");H.charCounter({"min":0,"max":N,"startAt":Q,"target":H.parents("form#post-form").find("div.text-counter"),"setIsValid":function(t){var n=$("div#post-title");n.toggleClass("has-error",!t),n.find(".js-invalid-alert").toggleClass("d-none",t)}})}});